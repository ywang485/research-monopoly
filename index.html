<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life Gambling with Scientific Research</title>
    <!-- Hand-drawn style fonts + Pixel art font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Caveat:wght@400;600;700&family=Indie+Flower&family=Patrick+Hand&family=Permanent+Marker&family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Paper texture overlay -->
    <div class="paper-texture"></div>

    <!-- Decorative formula doodles (background) -->
    <div class="formula-doodles">
        <span class="formula f1">E = mcÂ²</span>
        <span class="formula f2">âˆ«âˆ‚x</span>
        <span class="formula f3">Î£(nÂ²)</span>
        <span class="formula f4">Î» = h/p</span>
        <span class="formula f5">âˆ‡ Ã— B</span>
        <span class="formula f6">Ïˆ(x,t)</span>
        <span class="formula f7">âˆ‚Â²u/âˆ‚tÂ²</span>
        <span class="formula f8">lim xâ†’âˆ</span>
        <span class="formula f9">âˆ® FÂ·dr</span>
        <span class="formula f10">P(A|B)</span>
        <span class="formula f11">âˆ†G = âˆ†H</span>
        <span class="formula f12">F = ma</span>
    </div>

    <div id="game-container">
        <!-- Setup Screen -->
        <div id="setup-screen" class="screen notebook-page">
            <!-- Spiral binding decoration -->
            <div class="spiral-binding">
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
            </div>

            <div class="page-content">
                <h1 class="hand-title">
                    <span class="title-underline">Scientific Research is Gambling with Your Life</span>
                </h1>
                <p class="subtitle"> How much life can you invest? </p>

                <!-- Decorative tape -->
                <div class="tape tape-1"></div>

                <div class="setup-section sticky-note yellow">
                    <div class="pushpin"></div>
                    <h2>Research Topic</h2>
                    <div class="input-group">
                        <!--<label for="entity-type">What are we studying?</label>-->
                        <select id="entity-type" style="display: none;">
                            <option value="explanation">Explanation</option>
                            <option value="matter">Matter</option>
                            <option value="creature">Creature</option>
                            <option value="phenomenon">Social Phenomenon</option>
                            <option value="place">Place</option>
                            <option value="mechanism">Mechanism</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="entity-name">What are we studying?:</label>
                        <input type="text" id="entity-name" placeholder="e.g., Dark Matter, Bigfoot...">
                    </div>
                    <div id="entity-suggestions-container" class="entity-suggestions-container" style="display: none;">
                        <button id="generate-entities-btn" class="sketch-btn suggest-btn">ğŸ² Suggest Entities</button>
                        <div id="entity-suggestions" class="entity-suggestions"></div>
                    </div>
                </div>

                <div class="setup-section sticky-note pink">
                    <div class="paper-clip"></div>
                    <h2>ğŸ‘©â€ğŸ”¬ Players (2-4)</h2>
                    <div id="player-inputs">
                        <div class="player-input">
                            <input type="text" class="player-name" placeholder="Player 1 Name" value="Dr. Hypothesis">
                            <input type="color" class="player-color" value="#e74c3c">
                            <label class="ai-toggle"><input type="checkbox" class="player-ai"> AI</label>
                        </div>
                        <div class="player-input">
                            <input type="text" class="player-name" placeholder="Player 2 Name" value="Prof. Theory">
                            <input type="color" class="player-color" value="#3498db">
                            <label class="ai-toggle"><input type="checkbox" class="player-ai" checked> AI</label>
                        </div>
                    </div>
                    <div class="button-group">
                        <button id="add-player-btn" class="sketch-btn">+ Add Player</button>
                        <button id="remove-player-btn" class="sketch-btn">- Remove Player</button>
                    </div>
                </div>

                <div class="setup-section sticky-note blue">
                    <div class="tape tape-corner"></div>
                    <h2>ğŸ—ºï¸ Board Configuration</h2>
                    <div class="input-group">
                        <label for="map-select">Select Map:</label>
                        <select id="map-select">
                            <option value="default">Default Board</option>
                            <option value="custom">Load Custom Map</option>
                        </select>
                    </div>
                    <div id="custom-map-input" style="display: none;">
                        <textarea id="map-text" placeholder="Paste map configuration here..."></textarea>
                    </div>
                </div>

                <button id="start-game-btn" class="sketch-btn large">â–¶ START GAME!</button>

                <!-- Decorative stickers -->
                <div class="sticker sticker-star">â­</div>
                <div class="sticker sticker-lightbulb">ğŸ’¡</div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen" style="display: none;">
            <div id="game-header" class="notebook-header">
                <div id="entity-display" class="header-tag">
                    <span id="entity-info"></span>
                </div>
                <div id="llm-status" class="llm-indicator">
                    <span class="llm-icon">ğŸ¤–</span>
                    <span class="llm-text">Checking AI...</span>
                </div>
                <div id="turn-display" class="header-tag">
                    <span id="current-turn"></span>
                </div>
            </div>

            <div id="main-game-area">
                <div id="board-wrapper">
                    <div id="board-container" class="notebook-spread">
                        <div class="spread-binding"></div>
                        <canvas id="game-board"></canvas>
                    </div>
                    <div id="zoom-controls">
                        <button id="zoom-in-btn" class="zoom-btn" title="Zoom In">+</button>
                        <span id="zoom-level">100%</span>
                        <button id="zoom-out-btn" class="zoom-btn" title="Zoom Out">âˆ’</button>
                        <button id="zoom-reset-btn" class="zoom-btn" title="Reset Zoom">âŸ²</button>
                    </div>
                </div>

                <div id="side-panel">
                    <div id="players-panel" class="side-sticky green">
                        <div class="fold-corner"></div>
                        <h3>ğŸ‘©â€ğŸ”¬ Scientists</h3>
                        <div id="player-stats"></div>
                    </div>

                    <div id="underdeterminism-panel" class="side-sticky purple">
                        <div class="tape tape-small"></div>
                        <h3>ğŸ² Scientific Underdeterminism</h3>
                        <div id="underdeterminism-info">
                            <span class="npc-icon">ğŸ²</span>
                            <span id="npc-position">Position: Start</span>
                        </div>
                    </div>

                    <div id="theories-panel" class="side-sticky orange">
                        <div class="paper-clip clip-small"></div>
                        <h3>ğŸ“œ Established Theories</h3>
                        <div id="theories-list"></div>
                    </div>
                </div>
            </div>

            <div id="action-panel">
                <div id="game-log" class="torn-paper"></div>
                <div id="action-buttons">
                    <button id="roll-dice-btn" class="sketch-btn roll-btn">ğŸ² Roll Dice</button>
                </div>
            </div>
        </div>

        <!-- Modal for actions -->
        <div id="modal" class="modal" style="display: none;">
            <div class="modal-content torn-note">
                <div class="tape tape-top"></div>
                <h2 id="modal-title"></h2>
                <div id="modal-body"></div>
                <div id="modal-buttons"></div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="screen notebook-page" style="display: none;">
            <div class="spiral-binding">
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
                <div class="spiral-ring"></div>
            </div>

            <div class="page-content">
                <h1 class="hand-title">ğŸ““ GAME OVER ğŸ““</h1>
                <div id="winner-display" class="winner-card"></div>

                <!-- Theory Revelation Section -->
                <div id="theory-revelation" class="theory-revelation notebook-insert">
                    <div class="tape tape-left"></div>
                    <div class="tape tape-right"></div>
                    <h2 class="revelation-title">ğŸ“œ THE GRAND UNIFIED THEORY ğŸ“œ</h2>
                    <div id="theory-entity" class="theory-entity"></div>
                    <div id="theory-content" class="theory-content">
                        <div class="theory-loading">âœï¸ Synthesizing groundbreaking discoveries...</div>
                    </div>
                    <div id="theory-contributors" class="theory-contributors"></div>
                </div>

                <div id="final-stats" class="stats-board"></div>
                <button id="play-again-btn" class="sketch-btn large">ğŸ”„ PLAY AGAIN!</button>

                <div class="sticker sticker-trophy">ğŸ†</div>
            </div>
        </div>

        <!-- Board Tooltip -->
        <div id="board-tooltip" class="board-tooltip sketch-tooltip"></div>
    </div>

    <!-- Game modules (loaded in dependency order) -->
    <script src="js/constants.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/sound.js"></script>
    <script src="js/game-logic.js"></script>
    <script src="js/rendering.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/ui.js"></script>
    <script src="game.js"></script>
</body>
</html>
